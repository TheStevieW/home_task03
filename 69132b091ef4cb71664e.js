(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{358:function(e,t){},391:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-field"},[e._m(0),r("div",{staticClass:"edit-field__form"},[r("form",{staticClass:"review-form",on:{submit:function(t){return t.preventDefault(),e.addReviewCard(e.newReview)},reset:function(t){return t.preventDefault(),e.hideAddingCard(t)}}},[r("div",{staticClass:"review-form__container"},[r("div",{staticClass:"review-form__column"},[r("div",{staticClass:"review-form__image"},[r("div",{staticClass:"add-image"},[r("div",{staticClass:"add-image__icon",class:{hidden:e.renderedPhoto.length},style:e.renderedBackground}),r("input",{staticClass:"add-image__input",attrs:{type:"file",name:"reviews-image",id:"reviews-image"},on:{change:e.addPhoto}}),r("label",{staticClass:"add-image__label",attrs:{for:"reviews-image"}},[e._v("Добавить фото")]),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.photo")}})],1)])]),r("div",{staticClass:"review-form__column"},[r("div",{staticClass:"review-form-row"},[r("div",{staticClass:"review-form-row__block"},[r("label",{staticClass:"form__label",attrs:{for:"author-name"}},[e._v("Имя автора")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newReview.author,expression:"newReview.author"}],staticClass:"form__input",attrs:{type:"text",name:"name",id:"author-name",placeholder:"Ковальчук Дмитрий"},domProps:{value:e.newReview.author},on:{input:function(t){t.target.composing||e.$set(e.newReview,"author",t.target.value)}}}),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.author")}})],1),r("div",{staticClass:"review-form-row__block"},[r("label",{staticClass:"form__label",attrs:{for:"author-desc"}},[e._v("Титул автора")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newReview.occ,expression:"newReview.occ"}],staticClass:"form__input",attrs:{type:"text",name:"desc",id:"author-desc",placeholder:"Основатель LoftSchool"},domProps:{value:e.newReview.occ},on:{input:function(t){t.target.composing||e.$set(e.newReview,"occ",t.target.value)}}}),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.occ")}})],1)]),r("div",{staticClass:"review-form-row"},[r("div",{staticClass:"review-form-row__block review-form-row__block--textarea"},[r("label",{staticClass:"form__label form__label--textarea",attrs:{for:"review-text"}},[e._v("Описание")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newReview.text,expression:"newReview.text"}],staticClass:"form__input form__input--textarea",attrs:{name:"text",id:"review-text",placeholder:"Текст отзыва"},domProps:{value:e.newReview.text},on:{input:function(t){t.target.composing||e.$set(e.newReview,"text",t.target.value)}}}),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.text")}})],1)]),e._m(1)])])])])])};i._withStripped=!0;var n=r(93),o=r(356),a=r.n(o);function s(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=a.a.Validator,u={mixins:[a.a.mixin],props:{review:Object},components:{tooltipInput:function(){return r.e(0).then(r.bind(null,387))}},data:function(){return{renderedPhoto:"",newReview:l({},this.review)}},validators:{"newReview.author":function(e){return d.value(e).required("Добавьте имя")},"newReview.occ":function(e){return d.value(e).required("Добавьте титул")},"newReview.text":function(e){return d.value(e).required("Заполните отзыв")},"newReview.photo":function(e){return d.value(e).required("Добавьте фото")}},methods:l({},Object(n.b)("reviews",["addReview","updateReview"]),{},Object(n.b)("tooltip",["showTooltip"]),{hideAddingCard:function(){this.$emit("hideAddingCard")},addPhoto:function(e){var t=this;this.newReview.photo=e.target.files[0];var r=new FileReader;try{r.readAsDataURL(this.newReview.photo),r.onload=function(){t.renderedPhoto=r.result}}catch(e){}},addReviewCard:function(e){var t,r=this;return(t=regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.$validate();case 2:if(!t.sent){t.next=23;break}if(t.prev=3,!Object.keys(r.newReview).some((function(e){return r.newReview[e]!==r.review[e]}))){t.next=13;break}if(!e.id){t.next=11;break}return t.next=9,r.updateReview(e);case 9:t.next=13;break;case 11:return t.next=13,r.addReview(e);case 13:r.showTooltip({type:"success",message:"Отзыв успешно добавлен"}),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(3),i=t.t0.message,r.showTooltip({type:"error",message:i});case 20:return t.prev=20,r.$emit("hideAddingCard"),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[3,16,20,23]])})),function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){s(o,i,n,a,c,"next",e)}function c(e){s(o,i,n,a,c,"throw",e)}a(void 0)}))})()}}),computed:l({},Object(n.c)("reviews",["getReviews"]),{renderedBackground:function(){return this.renderedPhoto?"background-image: url(".concat(this.renderedPhoto,");"):""}}),created:function(){this.newReview=l({},this.review),this.review.photo&&(this.renderedPhoto="https://webdev-api.loftschool.com/"+this.review.photo)},watch:{review:function(){console.log("watch"),this.newReview=l({},this.review),this.renderedPhoto="https://webdev-api.loftschool.com/"+this.review.photo}}},w=(r(363),r(92)),f=Object(w.a)(u,i,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit-field__intro"},[t("h3",{staticClass:"review-form__title"},[this._v("Новый отзыв")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"review-form-row review-form-row--btns"},[t("button",{staticClass:"cancel-btn",attrs:{type:"reset"}},[this._v("Отмена")]),t("button",{staticClass:"form-btn",attrs:{type:"submit"}},[this._v("Сохранить")])])}],!1,null,null,null);f.options.__file="src/admin/pages/reviews/reviews-add-new.vue";t.default=f.exports}}]);